# ResourceModel Replication
Distributed system that shows how to replicate resource model through different microservice

### System structure

![alt text](https://github.com/ale8193/resourcemodel-replication/blob/master/system-for-resourcemodel-replication.png "System structure")

### Environment

To run this application:

- you need to have a `mongodb` database, you will setup db url in configuration files
- you need an `MQTT` broker available for `websocket` on port `1884`, if you need to setup `websocket` follow this link [mqtt enable websocket](https://blog.ithasu.org/2016/05/enabling-and-using-websockets-on-mosquitto/).

### Installation
```
git clone https://github.com/ale8193/resourcemodel-replication.git
```

#### Intallation: node-server
```
cd <resourcemodel-replication-path>/node-server
npm install
```

Then you need to setup config files, they are inside `config` folder of module `node-server` you will find sample file for development and production mode. You need to create two files:

- `development.json` adding the content present in `development.json.sample` and replacing current values with yours
- `production.json` adding the content present in `production.json.sample` and replacing current values with yours

After that you can start `node-server` in two ways:

- `npm run server` to start in production mode
- `npm run dev` to start in development mode with also nodemon 

NOTE: `node-server` run into the port `5000`

#### Intallation: react-gui
```
cd <resourcemodel-replication-path>/react-gui
npm install
```

As for `node-server` as you need to setup config files, they are inside `config` folder of module `react-gui/src` you will found sample file for development and production mode you need to create two files:

- `development.json` adding the content present in `development.json.sample` and replacing with your values
- `production.json` adding the content present in `production.json.sample` and replacing with your values

After all you can start `react-gui` by running the command:

- `npm run start` to start the client application

NOTE: `react-gui` run into the port `3000`

#### Installation: QA Projects
`QActor` project needs to be imported into `Eclipse` as new project then you need to generate the automated code, to do this simply change any of the line of `it.unibo.system.controller/src/system.qa` (with a space for example) and save the file. This will generate the missing code.

FInally you need to import also the `it.unibo.iss.libs` project into `Eclipse` in the same workspace. Than use `gradle` to import missing libraries (this file will be generated by the previous step).

To run `gradle` script you need to execute this operations:
```
cd <resourcemodel-replication-path>/it.unibo.system.controller
gradle -b build_ctxSystemController.gradle eclipse
```

NOTE: In `gradle` file you need to manually add these lines of code:
```
/*
TO BE ADDED by the application designer: COAP
*/
 	// https://mvnrepository.com/artifact/org.eclipse.californium/californium-core
	compile group: 'org.eclipse.californium', name: 'californium-core', version: '2.0.0-M11'
```
